class SelectMode{static Active(){let notes;SelIndicate.style.display=null,document.querySelectorAll(".note-preview").forEach(nt=>{nt.classList.add("selectmode")}),selectbox.classList.add("active"),selectmode=!0}static getSelectes(){let notes=document.querySelectorAll(".note-preview"),identifiers=[];return notes.forEach(nt=>{nt.querySelector(".select").classList.contains("active")&&identifiers.push([nt.getAttribute("identifier"),nt])}),identifiers}static DisableMode(){let notes;document.querySelectorAll(".note-preview").forEach(nt=>{nt.classList.remove("selectmode"),nt.querySelector(".select").classList.remove("active")}),selectbox.classList.remove("active"),selectmode=!1,SelIndicate.style.display="none",document.querySelector(".superspace")&&(document.querySelector(".superspace").style.display="none")}static RemoveSelectes(){let total=this.getSelectes(),bezier="cubic-bezier(0.230, 1.000, 0.320, 1.000)";Swal.fire({title:"Estas Seguro?",text:"Una vez borradas no hay forma de recuperarlas!",confirmButtonColor:"#3085d6",confirmButtonText:"Borrar",icon:"warning"}).then(result=>{result.isConfirmed&&(total.forEach(data=>{let note=data[1],identifier=data[0];DB.SecureRemove(identifier),document.querySelector(`.Editor[identifier="${identifier}"]`)&&document.querySelector(`.Editor[identifier="${identifier}"]`).CloseEditor(!0),note.animate({transform:"scale(0.7)",opacity:"0"},{duration:500,easing:bezier,fill:"forwards"}),setTimeout(()=>{Folders.Refresh(!1)},501)}),this.DisableMode())})}static NumSelectes(){let notes=document.querySelectorAll(".note-preview"),num=0;return notes.forEach(nt=>{nt.querySelector(".select").classList.contains("active")&&(num+=1)}),num}static SelectAll(){let notes=document.querySelectorAll(".note-preview"),status=[],numsels;notes.forEach(nt=>{nt.querySelector(".select").classList.contains("active")?status.push(!0):status.push(!1)}),1==status.every(st=>1==st)?notes.forEach(nt=>{nt.classList.add("selectmode"),nt.querySelector(".select").classList.remove("active"),document.querySelector(".selbtn").style.color=null}):notes.forEach(nt=>{document.querySelector(".selbtn").style.color="#f88706",nt.classList.add("selectmode"),nt.querySelector(".select").classList.add("active")}),document.querySelector(".numsels").innerHTML=`${SelectMode.NumSelectes()} Notas Seleccionadas`}static totalNotes(){let notes=document.querySelectorAll(".note-preview"),num=0;return notes.forEach(nt=>{num+=1}),num}}let selectmode=!1,first=!0,selectbox=document.querySelector(".SelectBox"),SelIndicate=document.querySelector(".selectedIndicate");SelIndicate.style.display="none";let OpenEditors=[];class FoldersClass{constructor(){this.DB(),this.actualfolder=this.DB().get()[0],localStorage.getItem("LastFolder")&&(this.actualfolder=localStorage.getItem("LastFolder")),this.Refresh(),this.menu=document.querySelector(".folderSection"),this.menu.style.display="none",this.notetab=document.querySelector(".NoteTab"),this.notetab.addEventListener("click",e=>{this.notetab.classList.contains("active")&&this.OpenMenu()}),this.isMenuOpen=!1,this.NotesDB=DB}DB(){let NDB=this.NotesDB,DB=[],lc=localStorage.getItem("Notas");function add(folder){return DB.find(lt=>lt==folder)?(console.error("ya existe una carpeta con ese nombre"),!1):(DB.push(folder),localStorage.setItem("Notas",JSON.stringify(DB)),!0)}function remove(folder){return"Notas"!=folder?(DB.splice(DB.findIndex(el=>el==folder),1),NDB.ReloadData().filter(nota=>nota.folder==folder).forEach(nota=>{NDB.SecureRemove(nota.identifier)}),localStorage.getItem("LastFolder")&&localStorage.setItem("LastFolder",DB[0]),localStorage.setItem("Notas",JSON.stringify(DB)),!0):(console.error("No se puede Eliminar la Carpeta Principal..."),!1)}function get(){return DB}return null!=lc?DB=JSON.parse(lc):(DB=["Notas"],localStorage.setItem("Notas",JSON.stringify(DB))),{add:e=>add(e),get:e=>get(e),remove:e=>remove(e)}}Refresh(firstanimation=!0){first=firstanimation;let folderSection=document.querySelector(".folderSection"),foldermenufather;document.querySelector(".foldersMenu").innerHTML='<div class="container"><h2>Carpetas</h2></div>';let folderMenu=document.querySelector(".foldersMenu .container");folderSection.innerHTML="<div class='container'></div>";let container=folderSection.querySelector(".container"),that=this,ContainerPc=document.querySelector(".foldersMenu .container");this.DB().get().forEach(folder=>{let fl=document.createElement("div");fl.classList.add("folder"),fl.folder=folder;let CantidadNotas=DB.ReloadData().filter(data=>data.folder==folder).length;fl.innerHTML=`<span class="textd" ><i class="material-icons">arrow_forward_ios</i>${folder}</span>${CantidadNotas}`;let flpc=document.createElement("div");function deletefolder(params){Swal.fire({icon:"warning",html:`Desea Borrar la carpeta <b>${fl.folder}</b>`,confirmButtonText:"borrar"}).then(result=>{result.isConfirmed&&(that.DeleteFolder(fl.folder)?Swal.fire({icon:"success",html:"Carpeta Borrada!",confirmButtonText:"ok"}):Swal.fire({icon:"error",html:"Ocurrio un Error!",confirmButtonText:"ok"}))})}flpc.classList.add("folder"),flpc.folder=folder,flpc.innerHTML=`<span class="textd" ><i class="material-icons">arrow_forward_ios</i>${folder}</span>${CantidadNotas}`,container.appendChild(fl),ContainerPc.appendChild(flpc),flpc.addEventListener("touchstart",e=>{let ms=0,timer=50,inte=setInterval(()=>{ms>=50&&"Notas"!=fl.folder&&(deletefolder(),clearInterval(inte)),ms+=1},10);function uped(u){clearInterval(inte),ms<50&&fl!=folderMenu.querySelector(".folder.active")&&(that.SelFolder(fl.folder),that.CloseMenu()),flpc.removeEventListener("touchend",uped)}flpc.addEventListener("touchend",uped)}),flpc.addEventListener("mousedown",e=>{let ms=0,timer=50,inte=setInterval(()=>{ms>=50&&"Notas"!=fl.folder&&(deletefolder(),clearInterval(inte)),ms+=1},10);function uped(u){clearInterval(inte),ms<50&&fl!=folderMenu.querySelector(".folder.active")&&(that.SelFolder(fl.folder),that.CloseMenu()),flpc.removeEventListener("mouseup",uped)}flpc.addEventListener("mouseup",uped)}),fl.addEventListener("mousedown",e=>{let ms=0,timer=50,inte=setInterval(()=>{ms>=50&&"Notas"!=fl.folder&&(deletefolder(),clearInterval(inte)),ms+=1},10);function uped(u){clearInterval(inte),ms<50&&fl!=folderSection.querySelector(".folder.active")&&(that.SelFolder(fl.folder),that.CloseMenu()),fl.removeEventListener("mouseup",uped)}fl.addEventListener("mouseup",uped)}),fl.addEventListener("touchstart",e=>{let ms=0,timer=50,inte=setInterval(()=>{ms>=50&&"Notas"!=fl.folder&&(deletefolder(),clearInterval(inte)),ms+=1},10);function uped(u){clearInterval(inte),ms<50&&fl!=folderSection.querySelector(".folder.active")&&(that.SelFolder(fl.folder),that.CloseMenu()),fl.removeEventListener("touchend",uped)}fl.addEventListener("touchend",uped)})}),this.DB().get().forEach(folder=>{this.actualfolder==folder&&this.SelFolder(folder,first)});let addbtnpc=document.createElement("div"),addbtn=document.createElement("div");addbtnpc.classList.add("addftbtn"),addbtn.classList.add("addftbtn"),addbtnpc.innerHTML="Nueva Carpeta",addbtn.innerHTML="Nueva Carpeta",addbtn.addEventListener("click",CreateFolder),addbtnpc.addEventListener("click",CreateFolder),container.appendChild(addbtn),folderMenu.parentNode.appendChild(addbtnpc)}SelFolder(folder,firstanimation=!0){SelectMode.DisableMode(),first=firstanimation,localStorage.setItem("LastFolder",folder),this.actualfolder=folder;let folderSection,fts=document.querySelector(".folderSection").querySelectorAll(".folder"),folderMenu,ftsm=document.querySelector(".foldersMenu .container").querySelectorAll(".folder");ftsm.forEach(ft=>{ft.classList.remove("active")}),fts.forEach(ft=>{ft.classList.remove("active")}),ftsm.forEach(ft=>{if(ft.folder==folder){let tabInit;ft.classList.add("active"),document.querySelector(".header .tab").querySelector("span").innerHTML=`${ft.folder}`}}),fts.forEach(ft=>{if(ft.folder==folder){let tabInit;ft.classList.add("active"),document.querySelector(".header .tab").querySelector("span").innerHTML=`${ft.folder}`}}),this.RefreshNotas()}RefreshNotas(){let container=document.querySelector(".notes-preview-container");container.classList.remove("not"),container.innerHTML="";let date=new Date,notesarray=DB.ReloadData().filter(nota=>nota.folder===this.actualfolder);notesarray.forEach((el,id)=>{let hour="",day="",year="",minute="",month="",AM_OR_PM="",ic="",lasted="";if(el.time.hour==date.getHours()&&el.time.day==date.getDate()&&el.time.month==date.getMonth()&&el.time.year==date.getFullYear()&&(lasted=Math.abs(date.getMinutes()-el.time.minute),lasted=0==lasted?"Justo Ahora":1==lasted?"Hace 1 minuto":`Hace ${lasted} minutos`),el.time.hour==date.getHours()&&el.time.day==date.getDate()&&el.time.month==date.getMonth()&&el.time.year==date.getFullYear()||(hour=el.time.hour,minute=el.time.minute<=9?"0"+el.time.minute:el.time.minute,ic=":",el.time.hour>=13&&(hour-=12),AM_OR_PM=el.time.hour>=12?"PM":"AM"),el.time.day!=date.getDate()||el.time.month!=date.getMonth()||el.time.year!=date.getFullYear()){day=el.time.day;let ayer=date.getDate()-1;month=months[date.getMonth()],day==ayer&&el.time.month==date.getMonth()&&el.time.year==date.getFullYear()&&(month="",day="Ayer")}el.time.year!=date.getFullYear()&&(year=el.time.year);let f={content:el.content.replace(/<.+?>/gim,"").substr(0,61)},note=document.createElement("div");note.setAttribute("identifier",el.identifier),note.classList.add("note-preview"),1==selectmode&&note.classList.add("selectmode"),1==first&&(note.style.animation="ini_note ease forwards 500ms"),note.innerHTML=`\n            <div class="note">${f.content.replace(/<.+?>/gim,"")}</div>\n            <div class="more">...</div>\n            <div class="date">${year} ${month} ${day} ${hour}${ic}${minute} ${AM_OR_PM} ${lasted}</div>\n            <div class="select"><div class="line"></div></div>\n            `,61!=f.content.length&&note.removeChild(note.querySelector(".more")),container.appendChild(note);let height=Math.round(note.getBoundingClientRect().height/10);note.style.gridRowEnd=`span ${height}`,note.addEventListener("mousedown",e=>{let ms=0,menutime=150,bezier="cubic-bezier(0.230, 1.000, 0.320, 1.000)";note.animate([{transform:"scale(0.9)"},{transform:"scale(0.98)"},{transform:"scale(1)"}],{duration:1e3,easing:bezier,fill:"forwards"});let clicks=setInterval(()=>{ms+=1,ms>=150&&(clearInterval(clicks),SelectMode.Active(),SelectThis())},3);function SelectThis(){let sel=note.querySelector(".select"),numsels;sel.classList.toggle("active"),document.querySelector(".numsels").innerHTML=`${SelectMode.NumSelectes()} Notas Seleccionadas`,sel.animate([{transform:"scale(0.9)"},{transform:"scale(0.98)"},{transform:"scale(1)"}],{duration:1e3,easing:bezier,fill:"forwards"}),SelectMode.NumSelectes()==SelectMode.totalNotes()?document.querySelector(".selbtn").style.color="#f88706":document.querySelector(".selbtn").style.color=null}function mouseup(e){if(clearInterval(clicks),ms<150&&"mouseleave"!=e.type)if(0==selectmode){let did=DB.ReloadData().findIndex(nota=>nota.identifier===el.identifier);new Editor(el.identifier)}else SelectThis();ms=0,note.removeEventListener("mouseleave",mouseup),note.removeEventListener("mouseup",mouseup)}note.addEventListener("mouseleave",mouseup),note.addEventListener("mouseup",mouseup)}),note.addEventListener("touchstart",e=>{let ms=0,menutime=150,bezier="cubic-bezier(0.230, 1.000, 0.320, 1.000)";note.animate([{transform:"scale(0.9)"},{transform:"scale(0.98)"},{transform:"scale(1)"}],{duration:1e3,easing:bezier,fill:"forwards"});let clicks=setInterval(()=>{ms+=1,ms>=150&&(clearInterval(clicks),SelectMode.Active(),SelectThis())},3);function SelectThis(){let sel=note.querySelector(".select"),numsels;sel.classList.toggle("active"),document.querySelector(".numsels").innerHTML=`${SelectMode.NumSelectes()} Notas Seleccionadas`,sel.animate([{transform:"scale(0.9)"},{transform:"scale(0.98)"},{transform:"scale(1)"}],{duration:1e3,easing:bezier,fill:"forwards"}),SelectMode.NumSelectes()==SelectMode.totalNotes()?document.querySelector(".selbtn").style.color="#f88706":document.querySelector(".selbtn").style.color=null}function mouseup(e){clearInterval(clicks),ms<150&&ms>=75&&(0==selectmode?new Editor(el.identifier):SelectThis()),ms=0,note.removeEventListener("touchend",mouseup)}note.addEventListener("touchend",mouseup)})}),1==first&&(first=!1),0==notesarray.length&&(container.classList.add("not"),container.innerHTML='\n            <div class="NoNotes">\n                <i class="material-icons">note_add</i>\n                <span>No hay Notas</span>\n                <div class="btn" onclick="newNote()">Crea una</div>\n            </div>\n            '),Search.actualsearch.trim()&&0!=notesarray.length&&Search.search(Search.actualsearch)}OpenMenu(){if(0==this.isMenuOpen&&1==window.matchMedia("(max-width: 500px)").matches){this.menu.style.display=null;let that=this;function winde(e){let ct;"folderSection"==e.path[0].classList[0]&&(that.CloseMenu(),window.removeEventListener("click",winde))}document.querySelector(".header").style.borderRadius="0px",this.menu.animate([{transform:"translateY(-100px)",opacity:"0"},{transform:"translateY(0px)",opacity:"1"}],{duration:500,easing:"ease",fill:"forwards"}),window.addEventListener("click",winde),this.isMenuOpen=!0}}DeleteFolder(fold){this.actualfolder==fold&&this.SelFolder(this.DB().get()[0]);let respuesta=this.DB().remove(fold);return this.Refresh(),respuesta}CloseMenu(){1==this.isMenuOpen&&(document.querySelector(".header").style.borderRadius=null,this.menu.animate([{transform:"translateY(0px)",opacity:"1"},{transform:"translateY(-100px)",opacity:"0"}],{duration:500,easing:"ease",fill:"forwards"}),setTimeout(()=>{this.menu.style.display="none"},501),this.isMenuOpen=!1)}}function CreateFolder(){Swal.fire({confirmButtonText:"Crear",input:"text",inputLabel:"Nueva Carpeta",inputPlaceholder:"Nombre"}).then(result=>{result.isConfirmed&&(result.value.trim()?Folders.DB().add(result.value)?Folders.Refresh():Swal.fire({icon:"error",text:"Esa Carpeta ya existe!"}):Swal.fire({icon:"error",text:"La Carpeta no puede tener un nombre vacio!"}))})}class SearchNotesClass{constructor(){let that=this,closebtn;this.actualsearch="",this.search_container=document.querySelector(".searchcontainer"),this.input=this.search_container.querySelector("input"),this.search_container.querySelector(".closebtnsearch").addEventListener("click",e=>{let val;this.input.value="",that.search(""),0==this.input.value.length?this.search_container.classList.remove("active"):this.search_container.classList.add("active")}),this.input.addEventListener("input",e=>{let val=this.input.value;0==val.length?this.search_container.classList.remove("active"):this.search_container.classList.add("active"),that.search(val)})}search(string){this.actualsearch=string;let notes=document.querySelectorAll(".note-preview"),note_container=document.querySelector(".notes-preview-container"),noresultelm=document.createElement("div");if(noresultelm.className="NoNotes NoResult",noresultelm.innerHTML='<i class="material-icons">search_off</i>\n        <span>No hay Resultados</span>',0==!notes.length)if(string.trim()){notes.forEach(note=>{note.classList.remove("none")});let total=0;if(notes.forEach(note=>{let result=document.querySelector(".NoResult");result&&result.parentNode.removeChild(result);let identifier=note.getAttribute("identifier"),data=DB.ReloadData().find(data=>data.identifier==identifier),regex=new RegExp(`${string}`,"gim");-1==data.content.search(regex)?note.classList.add("none"):total+=1}),0==total){let result;note_container.classList.add("not"),document.querySelector(".NoResult")||note_container.appendChild(noresultelm)}else note_container.classList.remove("not")}else{let result=document.querySelector(".NoResult");result&&result.parentNode.removeChild(result),note_container.classList.remove("not"),notes.forEach(note=>{note.classList.remove("none")})}}}let Search=new SearchNotesClass,Folders=new FoldersClass;function strikfire(n){for(let i=0;i<=n;i++){let date=new Date;i%3?DB.add(`note ${i}`,date.getDate(),date.getMonth(),date.getFullYear(),date.getHours(),date.getMinutes(),"indefinido ...",Folders.actualfolder):DB.add(`note ${i} Lorem ipsum dolor sit,facere ratione quam numquam?`,date.getDate(),date.getMonth(),date.getFullYear(),date.getHours(),date.getMinutes(),"indefinido ...",Folders.actualfolder)}}